!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a){window.ndarray=a("ndarray")},{ndarray:3}],2:[function(a,b){a=function c(b,d,e){function f(h,i){if(!d[h]){if(!b[h]){var j="function"==typeof a&&a;if(!i&&j)return j(h,!0);if(g)return g(h,!0);throw new Error("Cannot find module '"+h+"'")}var k=d[h]={exports:{}};b[h][0].call(k.exports,function(a){var c=b[h][1][a];return f(c?c:a)},k,k.exports,c,b,d,e)}return d[h].exports}for(var g="function"==typeof a&&a,h=0;h<e.length;h++)f(e[h]);return f}({PcZj9L:[function(a,b,c){function d(a,b,c){if(!(this instanceof d))return new d(a,b,c);var e=typeof a;if("base64"===b&&"string"===e)for(a=C(a);a.length%4!==0;)a+="=";var f;if("number"===e)f=F(a);else if("string"===e)f=d.byteLength(a,b);else{if("object"!==e)throw new Error("First argument needs to be a number, array or string.");f=F(a.length)}var g;U?g=D(new Uint8Array(f)):(g=this,g.length=f);var h;if(d.isBuffer(a))g.set(a);else if(H(a))for(h=0;f>h;h++)g[h]=d.isBuffer(a)?a.readUInt8(h):a[h];else if("string"===e)g.write(a,0,b);else if("number"===e&&!U&&!c)for(h=0;f>h;h++)g[h]=0;return g}function e(a,b,c,e){c=Number(c)||0;var f=a.length-c;e?(e=Number(e),e>f&&(e=f)):e=f;var g=b.length;if(g%2!==0)throw new Error("Invalid hex string");e>g/2&&(e=g/2);for(var h=0;e>h;h++){var i=parseInt(b.substr(2*h,2),16);if(isNaN(i))throw new Error("Invalid hex string");a[c+h]=i}return d._charsWritten=2*h,h}function f(a,b,c,e){return d._charsWritten=M(J(b),a,c,e)}function g(a,b,c,e){return d._charsWritten=M(K(b),a,c,e)}function h(a,b,c,d){return g(a,b,c,d)}function i(a,b,c,e){return d._charsWritten=M(L(b),a,c,e)}function k(a,b,c){return 0===b&&c===a.length?S.fromByteArray(a):S.fromByteArray(a.slice(b,c))}function l(a,b,c){var d="",e="";c=Math.min(a.length,c);for(var f=b;c>f;f++)a[f]<=127?(d+=N(e)+String.fromCharCode(a[f]),e=""):e+="%"+a[f].toString(16);return d+N(e)}function m(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(a[e]);return d}function n(a,b,c){return m(a,b,c)}function o(a,b,c){var d=a.length;(!b||0>b)&&(b=0),(!c||0>c||c>d)&&(c=d);for(var e="",f=b;c>f;f++)e+=I(a[f]);return e}function p(a,b,c,d){d||(R("boolean"==typeof c,"missing or invalid endian"),R(void 0!==b&&null!==b,"missing offset"),R(b+1<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){if(U){if(e>b+1)return a._dataview.getUint16(b,c);var f=new DataView(new ArrayBuffer(2));return f.setUint8(0,a[e-1]),f.getUint16(0,c)}var g;return c?(g=a[b],e>b+1&&(g|=a[b+1]<<8)):(g=a[b]<<8,e>b+1&&(g|=a[b+1])),g}}function q(a,b,c,d){d||(R("boolean"==typeof c,"missing or invalid endian"),R(void 0!==b&&null!==b,"missing offset"),R(b+3<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){if(U){if(e>b+3)return a._dataview.getUint32(b,c);for(var f=new DataView(new ArrayBuffer(4)),g=0;e>g+b;g++)f.setUint8(g,a[g+b]);return f.getUint32(0,c)}var h;return c?(e>b+2&&(h=a[b+2]<<16),e>b+1&&(h|=a[b+1]<<8),h|=a[b],e>b+3&&(h+=a[b+3]<<24>>>0)):(e>b+1&&(h=a[b+1]<<16),e>b+2&&(h|=a[b+2]<<8),e>b+3&&(h|=a[b+3]),h+=a[b]<<24>>>0),h}}function r(a,b,c,d){d||(R("boolean"==typeof c,"missing or invalid endian"),R(void 0!==b&&null!==b,"missing offset"),R(b+1<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){if(U){if(b+1===e){var f=new DataView(new ArrayBuffer(2));return f.setUint8(0,a[e-1]),f.getInt16(0,c)}return a._dataview.getInt16(b,c)}var g=p(a,b,c,!0),h=32768&g;return h?-1*(65535-g+1):g}}function s(a,b,c,d){d||(R("boolean"==typeof c,"missing or invalid endian"),R(void 0!==b&&null!==b,"missing offset"),R(b+3<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){if(U){if(b+3>=e){for(var f=new DataView(new ArrayBuffer(4)),g=0;e>g+b;g++)f.setUint8(g,a[g+b]);return f.getInt32(0,c)}return a._dataview.getInt32(b,c)}var h=q(a,b,c,!0),i=2147483648&h;return i?-1*(4294967295-h+1):h}}function t(a,b,c,d){return d||(R("boolean"==typeof c,"missing or invalid endian"),R(b+3<a.length,"Trying to read beyond buffer length")),U?a._dataview.getFloat32(b,c):T.read(a,b,c,23,4)}function u(a,b,c,d){return d||(R("boolean"==typeof c,"missing or invalid endian"),R(b+7<a.length,"Trying to read beyond buffer length")),U?a._dataview.getFloat64(b,c):T.read(a,b,c,52,8)}function v(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+1<a.length,"trying to write beyond buffer length"),O(b,65535));var f=a.length;if(!(c>=f))if(U)if(c+1===f){var g=new DataView(new ArrayBuffer(2));g.setUint16(0,b,d),a[c]=g.getUint8(0)}else a._dataview.setUint16(c,b,d);else for(var h=0,i=Math.min(f-c,2);i>h;h++)a[c+h]=(b&255<<8*(d?h:1-h))>>>8*(d?h:1-h)}function w(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+3<a.length,"trying to write beyond buffer length"),O(b,4294967295));var f=a.length;if(!(c>=f)){var g;if(U)if(c+3>=f){var h=new DataView(new ArrayBuffer(4));for(h.setUint32(0,b,d),g=0;f>g+c;g++)a[g+c]=h.getUint8(g)}else a._dataview.setUint32(c,b,d);else for(g=0,j=Math.min(f-c,4);j>g;g++)a[c+g]=b>>>8*(d?g:3-g)&255}}function x(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+1<a.length,"Trying to write beyond buffer length"),P(b,32767,-32768));var f=a.length;if(!(c>=f))if(U)if(c+1===f){var g=new DataView(new ArrayBuffer(2));g.setInt16(0,b,d),a[c]=g.getUint8(0)}else a._dataview.setInt16(c,b,d);else b>=0?v(a,b,c,d,e):v(a,65535+b+1,c,d,e)}function y(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+3<a.length,"Trying to write beyond buffer length"),P(b,2147483647,-2147483648));var f=a.length;if(!(c>=f))if(U)if(c+3>=f){var g=new DataView(new ArrayBuffer(4));g.setInt32(0,b,d);for(var h=0;f>h+c;h++)a[h+c]=g.getUint8(h)}else a._dataview.setInt32(c,b,d);else b>=0?w(a,b,c,d,e):w(a,4294967295+b+1,c,d,e)}function z(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+3<a.length,"Trying to write beyond buffer length"),Q(b,3.4028234663852886e38,-3.4028234663852886e38));var f=a.length;if(!(c>=f))if(U)if(c+3>=f){var g=new DataView(new ArrayBuffer(4));g.setFloat32(0,b,d);for(var h=0;f>h+c;h++)a[h+c]=g.getUint8(h)}else a._dataview.setFloat32(c,b,d);else T.write(a,b,c,d,23,4)}function A(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+7<a.length,"Trying to write beyond buffer length"),Q(b,1.7976931348623157e308,-1.7976931348623157e308));var f=a.length;if(!(c>=f))if(U)if(c+7>=f){var g=new DataView(new ArrayBuffer(8));g.setFloat64(0,b,d);for(var h=0;f>h+c;h++)a[h+c]=g.getUint8(h)}else a._dataview.setFloat64(c,b,d);else T.write(a,b,c,d,52,8)}function B(){return new d(this).buffer}function C(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function D(a){return a._isBuffer=!0,a.write=V.write,a.toString=V.toString,a.toLocaleString=V.toString,a.toJSON=V.toJSON,a.copy=V.copy,a.slice=V.slice,a.readUInt8=V.readUInt8,a.readUInt16LE=V.readUInt16LE,a.readUInt16BE=V.readUInt16BE,a.readUInt32LE=V.readUInt32LE,a.readUInt32BE=V.readUInt32BE,a.readInt8=V.readInt8,a.readInt16LE=V.readInt16LE,a.readInt16BE=V.readInt16BE,a.readInt32LE=V.readInt32LE,a.readInt32BE=V.readInt32BE,a.readFloatLE=V.readFloatLE,a.readFloatBE=V.readFloatBE,a.readDoubleLE=V.readDoubleLE,a.readDoubleBE=V.readDoubleBE,a.writeUInt8=V.writeUInt8,a.writeUInt16LE=V.writeUInt16LE,a.writeUInt16BE=V.writeUInt16BE,a.writeUInt32LE=V.writeUInt32LE,a.writeUInt32BE=V.writeUInt32BE,a.writeInt8=V.writeInt8,a.writeInt16LE=V.writeInt16LE,a.writeInt16BE=V.writeInt16BE,a.writeInt32LE=V.writeInt32LE,a.writeInt32BE=V.writeInt32BE,a.writeFloatLE=V.writeFloatLE,a.writeFloatBE=V.writeFloatBE,a.writeDoubleLE=V.writeDoubleLE,a.writeDoubleBE=V.writeDoubleBE,a.fill=V.fill,a.inspect=V.inspect,a.toArrayBuffer=B,0!==a.byteLength&&(a._dataview=new DataView(a.buffer,a.byteOffset,a.byteLength)),a}function E(a,b,c){return"number"!=typeof a?c:(a=~~a,a>=b?b:a>=0?a:(a+=b,a>=0?a:0))}function F(a){return a=~~Math.ceil(+a),0>a?0:a}function G(a){return(Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)})(a)}function H(a){return G(a)||d.isBuffer(a)||a&&"object"==typeof a&&"number"==typeof a.length}function I(a){return 16>a?"0"+a.toString(16):a.toString(16)}function J(a){for(var b=[],c=0;c<a.length;c++)if(a.charCodeAt(c)<=127)b.push(a.charCodeAt(c));else for(var d=encodeURIComponent(a.charAt(c)).substr(1).split("%"),e=0;e<d.length;e++)b.push(parseInt(d[e],16));return b}function K(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function L(a){return S.toByteArray(a)}function M(a,b,c,d){for(var e=0;d>e&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}function N(a){try{return decodeURIComponent(a)}catch(b){return String.fromCharCode(65533)}}function O(a,b){R("number"==typeof a,"cannot write a non-number as a number"),R(a>=0,"specified a negative value for writing an unsigned value"),R(b>=a,"value is larger than maximum value for type"),R(Math.floor(a)===a,"value has a fractional component")}function P(a,b,c){R("number"==typeof a,"cannot write a non-number as a number"),R(b>=a,"value larger than maximum allowed value"),R(a>=c,"value smaller than minimum allowed value"),R(Math.floor(a)===a,"value has a fractional component")}function Q(a,b,c){R("number"==typeof a,"cannot write a non-number as a number"),R(b>=a,"value larger than maximum allowed value"),R(a>=c,"value smaller than minimum allowed value")}function R(a,b){if(!a)throw new Error(b||"Failed assertion")}var S=a("base64-js"),T=a("ieee754");c.Buffer=d,c.SlowBuffer=d,c.INSPECT_MAX_BYTES=50,d.poolSize=8192;var U=function(){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer||"undefined"==typeof DataView)return!1;try{var a=new Uint8Array(0);return a.foo=function(){return 42},42===a.foo()}catch(b){return!1}}();d.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":return!0;default:return!1}},d.isBuffer=function(a){return a&&a._isBuffer},d.byteLength=function(a,b){switch(b||"utf8"){case"hex":return a.length/2;case"utf8":case"utf-8":return J(a).length;case"ascii":case"binary":return a.length;case"base64":return L(a).length;default:throw new Error("Unknown encoding")}},d.concat=function(a,b){if(!G(a))throw new Error("Usage: Buffer.concat(list, [totalLength])\nlist should be an Array.");if(0===a.length)return new d(0);if(1===a.length)return a[0];var c;if("number"!=typeof b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var e=new d(b),f=0;for(c=0;c<a.length;c++){var g=a[c];g.copy(e,f),f+=g.length}return e},d.prototype.write=function(a,b,c,d){if(isFinite(b))isFinite(c)||(d=c,c=void 0);else{var j=d;d=b,b=c,c=j}b=Number(b)||0;var k=this.length-b;switch(c?(c=Number(c),c>k&&(c=k)):c=k,d=String(d||"utf8").toLowerCase()){case"hex":return e(this,a,b,c);case"utf8":case"utf-8":return f(this,a,b,c);case"ascii":return g(this,a,b,c);case"binary":return h(this,a,b,c);case"base64":return i(this,a,b,c);default:throw new Error("Unknown encoding")}},d.prototype.toString=function(a,b,c){var d=this;if(a=String(a||"utf8").toLowerCase(),b=Number(b)||0,c=void 0!==c?Number(c):c=d.length,c===b)return"";switch(a){case"hex":return o(d,b,c);case"utf8":case"utf-8":return l(d,b,c);case"ascii":return m(d,b,c);case"binary":return n(d,b,c);case"base64":return k(d,b,c);default:throw new Error("Unknown encoding")}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},d.prototype.copy=function(a,b,c,d){var e=this;if(c||(c=0),d||0===d||(d=this.length),b||(b=0),d!==c&&0!==a.length&&0!==e.length){if(c>d)throw new Error("sourceEnd < sourceStart");if(0>b||b>=a.length)throw new Error("targetStart out of bounds");if(0>c||c>=e.length)throw new Error("sourceStart out of bounds");if(0>d||d>e.length)throw new Error("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);for(var f=0;d-c>f;f++)a[f+b]=this[f+c]}},d.prototype.slice=function(a,b){var c=this.length;if(a=E(a,c,0),b=E(b,c,c),U)return D(this.subarray(a,b));for(var e=b-a,f=new d(e,void 0,!0),g=0;e>g;g++)f[g]=this[g+a];return f},d.prototype.readUInt8=function(a,b){var c=this;return b||(R(void 0!==a&&null!==a,"missing offset"),R(a<c.length,"Trying to read beyond buffer length")),a>=c.length?void 0:c[a]},d.prototype.readUInt16LE=function(a,b){return p(this,a,!0,b)},d.prototype.readUInt16BE=function(a,b){return p(this,a,!1,b)},d.prototype.readUInt32LE=function(a,b){return q(this,a,!0,b)},d.prototype.readUInt32BE=function(a,b){return q(this,a,!1,b)},d.prototype.readInt8=function(a,b){var c=this;if(b||(R(void 0!==a&&null!==a,"missing offset"),R(a<c.length,"Trying to read beyond buffer length")),!(a>=c.length)){if(U)return c._dataview.getInt8(a);var d=128&c[a];return d?-1*(255-c[a]+1):c[a]}},d.prototype.readInt16LE=function(a,b){return r(this,a,!0,b)},d.prototype.readInt16BE=function(a,b){return r(this,a,!1,b)},d.prototype.readInt32LE=function(a,b){return s(this,a,!0,b)},d.prototype.readInt32BE=function(a,b){return s(this,a,!1,b)},d.prototype.readFloatLE=function(a,b){return t(this,a,!0,b)},d.prototype.readFloatBE=function(a,b){return t(this,a,!1,b)},d.prototype.readDoubleLE=function(a,b){return u(this,a,!0,b)},d.prototype.readDoubleBE=function(a,b){return u(this,a,!1,b)},d.prototype.writeUInt8=function(a,b,c){var d=this;c||(R(void 0!==a&&null!==a,"missing value"),R(void 0!==b&&null!==b,"missing offset"),R(b<d.length,"trying to write beyond buffer length"),O(a,255)),b>=d.length||(d[b]=a)},d.prototype.writeUInt16LE=function(a,b,c){v(this,a,b,!0,c)},d.prototype.writeUInt16BE=function(a,b,c){v(this,a,b,!1,c)},d.prototype.writeUInt32LE=function(a,b,c){w(this,a,b,!0,c)},d.prototype.writeUInt32BE=function(a,b,c){w(this,a,b,!1,c)},d.prototype.writeInt8=function(a,b,c){var d=this;c||(R(void 0!==a&&null!==a,"missing value"),R(void 0!==b&&null!==b,"missing offset"),R(b<d.length,"Trying to write beyond buffer length"),P(a,127,-128)),b>=d.length||(U?d._dataview.setInt8(b,a):a>=0?d.writeUInt8(a,b,c):d.writeUInt8(255+a+1,b,c))},d.prototype.writeInt16LE=function(a,b,c){x(this,a,b,!0,c)},d.prototype.writeInt16BE=function(a,b,c){x(this,a,b,!1,c)},d.prototype.writeInt32LE=function(a,b,c){y(this,a,b,!0,c)},d.prototype.writeInt32BE=function(a,b,c){y(this,a,b,!1,c)},d.prototype.writeFloatLE=function(a,b,c){z(this,a,b,!0,c)},d.prototype.writeFloatBE=function(a,b,c){z(this,a,b,!1,c)},d.prototype.writeDoubleLE=function(a,b,c){A(this,a,b,!0,c)},d.prototype.writeDoubleBE=function(a,b,c){A(this,a,b,!1,c)},d.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),"string"==typeof a&&(a=a.charCodeAt(0)),"number"!=typeof a||isNaN(a))throw new Error("value is not a number");if(b>c)throw new Error("end < start");if(c!==b&&0!==this.length){if(0>b||b>=this.length)throw new Error("start out of bounds");if(0>c||c>this.length)throw new Error("end out of bounds");for(var d=b;c>d;d++)this[d]=a}},d.prototype.inspect=function(){for(var a=[],b=this.length,d=0;b>d;d++)if(a[d]=I(this[d]),d===c.INSPECT_MAX_BYTES){a[d+1]="...";break}return"<Buffer "+a.join(" ")+">"};var V=d.prototype},{"base64-js":3,ieee754:4}],"native-buffer-browserify":[function(a,b){b.exports=a("PcZj9L")},{}],3:[function(a,b){function c(a,b){var c=a.length,d=Number(arguments[1])||0;for(d=0>d?Math.ceil(d):Math.floor(d),0>d&&(d+=c);c>d;d++)if("string"==typeof a&&a.charAt(d)===b||"string"!=typeof a&&a[d]===b)return d;return-1}!function(){"use strict";function a(a){var b,d,f,g,h,i;if(a.length%4>0)throw"Invalid string. Length must be a multiple of 4";for(h=c(a,"="),h=h>0?a.length-h:0,i=[],f=h>0?a.length-4:a.length,b=0,d=0;f>b;b+=4,d+=3)g=c(e,a.charAt(b))<<18|c(e,a.charAt(b+1))<<12|c(e,a.charAt(b+2))<<6|c(e,a.charAt(b+3)),i.push((16711680&g)>>16),i.push((65280&g)>>8),i.push(255&g);return 2===h?(g=c(e,a.charAt(b))<<2|c(e,a.charAt(b+1))>>4,i.push(255&g)):1===h&&(g=c(e,a.charAt(b))<<10|c(e,a.charAt(b+1))<<4|c(e,a.charAt(b+2))>>2,i.push(g>>8&255),i.push(255&g)),i}function d(a){function b(a){return e.charAt(a>>18&63)+e.charAt(a>>12&63)+e.charAt(a>>6&63)+e.charAt(63&a)}var c,d,f,g=a.length%3,h="";for(c=0,f=a.length-g;f>c;c+=3)d=(a[c]<<16)+(a[c+1]<<8)+a[c+2],h+=b(d);switch(g){case 1:d=a[a.length-1],h+=e.charAt(d>>2),h+=e.charAt(d<<4&63),h+="==";break;case 2:d=(a[a.length-2]<<8)+a[a.length-1],h+=e.charAt(d>>10),h+=e.charAt(d>>4&63),h+=e.charAt(d<<2&63),h+="="}return h}var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";b.exports.toByteArray=a,b.exports.fromByteArray=d}()},{}],4:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?0/0:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||1/0===b?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}]},{},[]),b.exports=a("native-buffer-browserify").Buffer},{}],3:[function(a,b){function c(a,b){return a[0]-b[0]}function d(){var a,b=this.stride,d=new Array(b.length);for(a=0;a<d.length;++a)d[a]=[Math.abs(b[a]),a];d.sort(c);var e=new Array(d.length);for(a=0;a<e.length;++a)e[a]=d[a][1];return e}function e(a,b){if(0===b){var c=new Function([k,"ZeroArray.prototype.dtype='"+a+"'","return function construct_ZeroArray(a,b,c,d){return new ZeroArray(a,d)}"].join("\n"));return c()}var e="generic"===a,f=["'use strict'"],g=i(b),h=g.map(function(a){return"i"+a}),m="this.offset+"+g.map(function(a){return["this._stride",a,"*i",a].join("")}).join("+"),n=["View",b,"d",a].join("");f.push(["function ",n,"(a,",g.map(function(a){return"b"+a}).join(","),",",g.map(function(a){return"c"+a}).join(","),",d){this.data=a"].join(""));for(var o=0;b>o;++o)f.push(["this._shape",o,"=b",o,"|0"].join(""));for(var o=0;b>o;++o)f.push(["this._stride",o,"=c",o,"|0"].join(""));f.push("this.offset=d|0}"),f.push(["var proto=",n,".prototype"].join("")),f.push(["proto.dtype='",a,"'"].join("")),f.push("proto.dimension="+b);var p=["VStride",b,"d",a].join(""),q=["VShape",b,"d",a].join(""),r={stride:p,shape:q};for(var s in r){var t=r[s];f.push(["function ",t,"(v) {this._v=v} var aproto=",t,".prototype"].join("")),f.push(["aproto.length=",b].join(""));for(var u=[],o=0;b>o;++o)u.push(["this._v._",s,o].join(""));f.push(["aproto.toJSON=function ",t,"_toJSON(){return [",u.join(","),"]}"].join("")),f.push(["aproto.toString=function ",t,"_toString(){return [",u.join(","),"].join()}"].join(""));for(var o=0;b>o;++o)f.push(["Object.defineProperty(aproto,",o,",{get:function(){return this._v._",s,o,"},set:function(v){return this._v._",s,o,"=v|0},enumerable:true})"].join(""));for(var o=0;o<j.length;++o)j[o]in Array.prototype&&f.push(["aproto.",j[o],"=Array.prototype.",j[o]].join(""));f.push(["Object.defineProperty(proto,'",s,"',{get:function ",t,"_get(){return new ",t,"(this)},set: function ",t,"_set(v){"].join(""));for(var o=0;b>o;++o)f.push(["this._",s,o,"=v[",o,"]|0"].join(""));f.push("return v}})")}f.push(["Object.defineProperty(proto,'size',{get:function ",n,"_size(){return ",g.map(function(a){return["this._shape",a].join("")}).join("*"),"}})"].join("")),1===b?f.push("proto.order=[0]"):(f.push("Object.defineProperty(proto,'order',{get:"),4>b?(f.push(["function ",n,"_order(){"].join("")),2===b?f.push("return (Math.abs(this._stride0)>Math.abs(this._stride1))?[1,0]:[0,1]}})"):3===b&&f.push("var s0=Math.abs(this._stride0),s1=Math.abs(this._stride1),s2=Math.abs(this._stride2);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):f.push("ORDER})")),f.push(["proto.set=function ",n,"_set(",h.join(","),",v){"].join("")),e?f.push(["return this.data.set(",m,",v)}"].join("")):f.push(["return this.data[",m,"]=v}"].join("")),f.push(["proto.get=function ",n,"_get(",h.join(","),"){"].join("")),e?f.push(["return this.data.get(",m,")}"].join("")):f.push(["return this.data[",m,"]}"].join("")),f.push(["proto.hi=function ",n,"_hi(",h.join(","),"){return new ",n,"(this.data,",g.map(function(a){return["(typeof i",a,"!=='number'||i",a,"<0)?this._shape",a,":i",a,"|0"].join("")}).join(","),",",g.map(function(a){return"this._stride"+a}).join(","),",this.offset)}"].join(""));var v=g.map(function(a){return"a"+a+"=this._shape"+a}),w=g.map(function(a){return"c"+a+"=this._stride"+a});f.push(["proto.lo=function ",n,"_lo(",h.join(","),"){var b=this.offset,d=0,",v.join(","),",",w.join(",")].join(""));for(var o=0;b>o;++o)f.push(["if(typeof i",o,"==='number'&&i",o,">=0){d=i",o,"|0;b+=c",o,"*d;a",o,"-=d}"].join(""));f.push(["return new ",n,"(this.data,",g.map(function(a){return"a"+a}).join(","),",",g.map(function(a){return"c"+a}).join(","),",b)}"].join("")),f.push(["proto.step=function ",n,"_step(",h.join(","),"){var ",g.map(function(a){return"a"+a+"=this._shape"+a}).join(","),",",g.map(function(a){return"b"+a+"=this._stride"+a}).join(","),",c=this.offset,d=0,ceil=Math.ceil"].join(""));for(var o=0;b>o;++o)f.push(["if(typeof i",o,"==='number'){d=i",o,"|0;if(d<0){c+=b",o,"*(a",o,"-1);a",o,"=ceil(-a",o,"/d)}else{a",o,"=ceil(a",o,"/d)}b",o,"*=d}"].join(""));f.push(["return new ",n,"(this.data,",g.map(function(a){return"a"+a}).join(","),",",g.map(function(a){return"b"+a}).join(","),",c)}"].join(""));for(var x=new Array(b),y=new Array(b),o=0;b>o;++o)x[o]=["a[i",o,"|0]"].join(""),y[o]=["b[i",o,"|0]"].join("");f.push(["proto.transpose=function ",n,"_transpose(",h,"){var a=this.shape,b=this.stride;return new ",n,"(this.data,",x.join(","),",",y.join(","),",this.offset)}"].join("")),f.push(["proto.pick=function ",n,"_pick(",h,"){var a=[],b=[],c=this.offset"].join(""));for(var o=0;b>o;++o)f.push(["if(typeof i",o,"==='number'&&i",o,">=0){c=(c+this._stride",o,"*i",o,")|0}else{a.push(this._shape",o,");b.push(this._stride",o,")}"].join(""));f.push("var ctor=CTOR_LIST[a.length];return ctor(this.data,a,b,c)}"),f.push(["return function construct_",n,"(data,shape,stride,offset){return new ",n,"(data,",g.map(function(a){return"shape["+a+"]"}).join(","),",",g.map(function(a){return"stride["+a+"]"}).join(","),",offset)}"].join(""));var z=new Function("CTOR_LIST","ORDER",f.join("\n"));return z(l[a],d)}function f(a){return a instanceof Float64Array?"float64":a instanceof Float32Array?"float32":a instanceof Int32Array?"int32":a instanceof Uint32Array?"uint32":a instanceof Uint8Array?"uint8":a instanceof Uint16Array?"uint16":a instanceof Int16Array?"int16":a instanceof Int8Array?"int8":a instanceof Uint8ClampedArray?"uint8_clamped":"undefined"!=typeof h&&a instanceof h?"buffer":a instanceof Array?"array":"generic"}function g(a,b,c,d){void 0===b&&(b=[a.length]);var g=b.length;if(void 0===c){c=new Array(g);for(var h=g-1,i=1;h>=0;--h)c[h]=i,i*=b[h]}if(void 0===d){d=0;for(var h=0;g>h;++h)c[h]<0&&(d-=(b[h]-1)*c[h])}for(var j=f(a),k=l[j];k.length<=g;)k.push(e(j,k.length));var m=k[g];return m(a,b,c,d)}var h=a("__browserify_Buffer"),i=a("iota-array"),j=["concat","join","slice","toString","indexOf","lastIndexOf","forEach","every","some","filter","map","reduce","reduceRight"],k="function ZeroArray(a,d) {this.data = a;this.offset = d};var proto=ZeroArray.prototype;proto.size=0;proto.shape=[];proto.stride=[];proto.order=[];proto.get=proto.set=function() {return Number.NaN};proto.lo=proto.hi=proto.transpose=proto.step=proto.pick=function() {return new ZeroArray(this.data,this.shape,this.stride,this.offset)}",l={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};b.exports=g},{__browserify_Buffer:2,"iota-array":4}],4:[function(a,b){"use strict";function c(a){for(var b=new Array(a),c=0;a>c;++c)b[c]=c;return b}b.exports=c},{}]},{},[1]);var Civilization;Civilization={Entity:{},Game:{},Util:{}},Civilization.Language={PLAYER_TURN:"Click on any tile to take control of it",CPU_TURN:"Waiting for other players to move...",GAME_FINISHED:"Game over! {0} is the winner with {1} points"},Function.prototype.property=function(a,b){return Object.defineProperty(this.prototype,a,b)},Civilization.Util.Math={randomIntBetween:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)}},String.prototype.format=function(){var a,b,c;return a=arguments,c=/\{(\d+)\}/g,b=function(b,c){return c in a?a[c]:b},this.replace(c,b)},Civilization.Entity.Player=function(){function a(a,b){var c;this.name=a,this.mainColor=b,this.id=this.mainColor,this.fillColor=this.mainColor,c=tinycolor.darken(this.mainColor.toString(16),30),this.borderColor=parseInt(c.toHex(),16)}return a}();var _ref,__hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};Civilization.Entity.CPU=function(a){function b(){return _ref=b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.chooseTile=function(a){for(var b;!b||b.owner;)b=a.getRandomTile();return b},b}(Civilization.Entity.Player),Civilization.Entity.Tile=function(){function a(){this.graphics=new PIXI.Graphics}return a.prototype.fillColor=15920612,a.prototype.borderColor=14275015,a.property("coords",{get:function(){return{x:this.x/TILE_SIZE,y:this.y/TILE_SIZE}}}),a.property("owner",{get:function(){return this._owner},set:function(a){return this._owner=a,this.fillColor=this._owner.fillColor,this.borderColor=this._owner.borderColor}}),a.prototype.draw=function(a,b){return null!=a&&null!=b?(this.x=a,this.y=b):this.graphics.clear(),this.graphics.beginFill(this.fillColor),this.graphics.lineStyle(1,this.borderColor,1),this.graphics.drawRect(this.x,this.y,TILE_SIZE,TILE_SIZE),this.graphics.endFill()},a.prototype.getDisplayObject=function(){return this.graphics},a}(),Civilization.Game.Logger=function(){function a(){}return a.prototype.history=[],a.prototype._log=function(a,b){return console[a].apply(console,Array.prototype.slice.call(b)),this.history.push({level:a,arguments:b})},a.prototype.log=function(){return this._log("log",arguments)},a.prototype.debug=function(){return this._log("debug",arguments)},a.prototype.info=function(){return this._log("info",arguments)},a.prototype.warn=function(){return this._log("warn",arguments)},a.prototype.error=function(){return this._log("error",arguments)},a}(),Civilization.Game.Map=function(){function a(a,b){this.xTiles=a,this.yTiles=b,this.tiles=ndarray([],[this.xTiles,this.yTiles]),this.resetTiles(),this.texture=new PIXI.RenderTexture(GAME_WIDTH,GAME_HEIGHT),this.DO=new PIXI.Sprite(this.texture),this.DO.hitArea=new PIXI.Rectangle(0,0,GAME_WIDTH,GAME_HEIGHT),this.DO.interactive=!0}return a.prototype.ownedTiles=0,a.prototype.drawTile=function(a,b,c){return a.draw(b,c),this.texture.render(a.getDisplayObject())},a.prototype.setTileOwner=function(a,b){return a.owner||this.ownedTiles++,a.owner=b,this.drawTile(a),this.expandTilesFrom(a)},a.prototype.getTile=function(a,b){return this.tiles.get(a,b)},a.prototype.getTileAtCoords=function(a,b){var c,d,e,f;return c=Math.floor(a/TILE_SIZE)*TILE_SIZE,d=Math.floor(b/TILE_SIZE)*TILE_SIZE,e=c/TILE_SIZE,f=d/TILE_SIZE,this.getTile(e,f)},a.prototype.getRandomTile=function(){var a,b;return a=Civilization.Util.Math.randomIntBetween(0,this.xTiles-1),b=Civilization.Util.Math.randomIntBetween(0,this.yTiles-1),this.getTile(a,b)},a.prototype.getAdjacentTiles=function(a){var b,c;return b=a.coords.x,c=a.coords.y,[this.tiles.get(b,c-1),this.tiles.get(b,c+1),this.tiles.get(b+1,c),this.tiles.get(b-1,c)]},a.prototype.expandTilesFrom=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;for(f=3,h=a.coords.x,i=a.coords.y,p=this.getAdjacentTiles(a),r=[],k=0,m=p.length;m>k;k++)if(g=p[k]){for(c={},q=this.getAdjacentTiles(g),l=0,n=q.length;n>l;l++)b=q[l],b&&b.owner&&(null==c[o=b.owner.id]&&(c[o]={owner:b.owner,count:0}),c[b.owner.id].count++);r.push(function(){var a;a=[];for(j in c){if(b=c[j],d=g.coords.x,e=g.coords.y,b.count>=f&&b.owner!==g.owner){LOGGER.log("Tile at ["+d+", "+e+"] taken by "+b.owner.name),this.setTileOwner(g,b.owner);break}a.push(void 0)}return a}.call(this))}return r},a.prototype.eachTile=function(a){var b,c,d,e,f;for(f=[],b=d=0,e=this.tiles.shape[0]-1;e>=0?e>=d:d>=e;b=e>=0?++d:--d)f.push(function(){var d,e,f;for(f=[],c=d=0,e=this.tiles.shape[1]-1;e>=0?e>=d:d>=e;c=e>=0?++d:--d)f.push(a(this.tiles.get(b,c),b,c));return f}.call(this));return f},a.prototype.resetTiles=function(){var a=this;return this.eachTile(function(b,c,d){return a.tiles.set(c,d,new Civilization.Entity.Tile)})},a.prototype.draw=function(){var a=this;return this.eachTile(function(b,c,d){return a.drawTile(b,c*TILE_SIZE,d*TILE_SIZE)})},a.prototype.getDisplayObject=function(){return this.DO},a}(),Civilization.Game.Manager=function(){function a(a,b){var c,d=this;this.player=a,this.cpus=b,this.renderer=PIXI.autoDetectRenderer(GAME_WIDTH,GAME_HEIGHT),this.stage=new PIXI.Stage(16777215,c=!0),this.info=new Civilization.Game.InfoBar,this.map=new Civilization.Game.Map(X_TILES,Y_TILES),this.map.getDisplayObject().click=function(a){var b;if(d.state.is("player")&&(b=d.map.getTileAtCoords(a.global.x,a.global.y),!b.owner))return LOGGER.log(""+d.player.name+" placed tile at ["+b.coords.x+", "+b.coords.y+"]"),d.map.setTileOwner(b,d.player),d.updateState(),d.state.finishTurn()},this.state=Civilization.Game.State.create(),this.state.onplayer=function(){return d.info.setText(Civilization.Language.PLAYER_TURN),d.updateState()},this.state.oncpu=function(){var a,b,c,e,f;for(d.info.setText(Civilization.Language.CPU_TURN),d.updateState(),f=d.cpus,c=0,e=f.length;e>c&&(a=f[c],!d.state.is("finished"));c++)b=a.chooseTile(d.map),LOGGER.log(""+a.name+" placed tile at ["+b.coords.x+", "+b.coords.y+"]"),d.map.setTileOwner(b,a),d.updateState(),d.state.finishTurn();return d.state.is("finished")?void 0:d.state.finishRound()},this.state.onbeforefinishTurn=function(){return d.map.ownedTiles===X_TILES*Y_TILES?(d.state.finishGame(),!1):void 0},this.state.onfinished=function(){var a,b,c,e;c={},d.map.eachTile(function(a){var b;return null==c[b=a.owner.id]&&(c[b]={owner:a.owner,score:0}),c[a.owner.id].score+=10}),a=[];for(e in c)b=c[e],LOGGER.log(""+b.owner.name+" scored "+b.score),a.push(b);return a.sort(function(a,b){return a.score<b.score?-1:a.score>b.score?1:0}).reverse(),LOGGER.log("Winner is "+a[0].owner.name+" with "+a[0].score+" points"),d.info.setText(Civilization.Language.GAME_FINISHED.format(a[0].owner.name,a[0].score)),d.updateState()}}var b;return b=Civilization.Game.Map,a.prototype.start=function(){return this.updateState(),this.info.setText(Civilization.Language.PLAYER_TURN),this.stage.addChild(this.map.getDisplayObject()),this.stage.addChild(this.info.getDisplayObject()),this.map.draw(),this.updateState()},a.prototype.updateState=function(){return this.renderer.render(this.stage)
},a}(),Civilization.Game.InfoBar=function(){function a(){this.text=new Civilization.Game.Text("",{font:"10pt Monospace",fill:"#000000"}),this.text.anchor.x=.5,this.text.position.x=GAME_WIDTH/2,this.text.position.y=GAME_HEIGHT-INFOBAR_SIZE+5}return a.prototype.setText=function(a){return this.text.setText(a)},a.prototype.getDisplayObject=function(){return this.text},a}(),Civilization.Game.Statistics=function(){function a(){var a,b;a={x:10,y:10},b=140,this.text=new Civilization.Game.Text("",{wordWrap:!0,wordWrapWidth:b}),this.text.anchor.x=1,this.text.position.x=GAME_WIDTH-a.x,this.text.position.y=a.y,this.update()}return a.prototype.turns=0,a.prototype.update=function(){return this.text.setText("Turns: "+this.turns)},a.prototype.getDisplayObject=function(){return this.text},a}(),Civilization.Game.State=function(){function a(){}return a.create=function(){var a;return a=StateMachine.create({initial:"player",events:[{name:"finishTurn",from:"player",to:"cpu"},{name:"finishTurn",from:"cpu",to:"cpu"},{name:"finishRound",from:["cpu","player"],to:"player"},{name:"finishGame",from:"*",to:"finished"}]})},a}();var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};Civilization.Game.Text=function(a){function b(a,c){var d,e,f;null==a&&(a=""),null==c&&(c={}),e={font:"16px Monospace",align:"left",fill:"rgba(80, 80, 80, 0.65)",stroke:"rgba(0, 0, 0, 0.4)",strokeThickness:1};for(d in c)f=c[d],e[d]=f;b.__super__.constructor.call(this,a,e)}return __extends(b,a),b}(PIXI.Text);var GAME_HEIGHT,GAME_WIDTH,INFOBAR_SIZE,LOGGER,TILE_SIZE,X_TILES,Y_TILES,loadGame;INFOBAR_SIZE=30,TILE_SIZE=40,X_TILES=16,Y_TILES=12,GAME_WIDTH=TILE_SIZE*X_TILES,GAME_HEIGHT=TILE_SIZE*Y_TILES+INFOBAR_SIZE,LOGGER=new Civilization.Game.Logger,loadGame=function(){var a,b,c,d,e,f,g;for(c=2,b=[6076508,15773006,14242639,6013150],d=[],e=g=1;c>=1?c>=g:g>=c;e=c>=1?++g:--g)d.push(new Civilization.Entity.CPU("CPU "+e,b[e-1]));return f=new Civilization.Entity.Player("Player 1",4361162),LOGGER.log(""+d.length+" CPU players have joined the game"),LOGGER.log(""+f.name+" has joined the game"),a=new Civilization.Game.Manager(f,d),document.body.appendChild(a.renderer.view),a.start()};